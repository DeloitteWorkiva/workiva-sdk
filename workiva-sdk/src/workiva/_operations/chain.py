"""Chains API â€” chain namespace.

Auto-generated by codegen. Do not edit manually.
"""

from __future__ import annotations

from typing import Any, Optional

import httpx

from workiva._constants import _API
from workiva._operations._base import BaseNamespace


class Chain(BaseNamespace):
    """Chain operations."""

    _api: _API = _API.CHAINS

    def export_chain(
        self,
        *,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Export a chain

        Returns an encoded string to be stored in a file with a `.chain`
        extension. The `.chain` file can then be used later during an import
        chain call.
        > **Note:** The exported chain will automatically expire and become
        unusable after 14 days. This has no bearing on the original chain or any
        imported copies.
        """
        return self._client.request(
            "POST",
            self._api,
            "/v1/chains/{chain_id}/export",
            path_params={
                "chain_id": chain_id,
            },
            timeout=timeout,
        )

    async def export_chain_async(
        self,
        *,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Export a chain (async)

        Returns an encoded string to be stored in a file with a `.chain`
        extension. The `.chain` file can then be used later during an import
        chain call.
        > **Note:** The exported chain will automatically expire and become
        unusable after 14 days. This has no bearing on the original chain or any
        imported copies.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/v1/chains/{chain_id}/export",
            path_params={
                "chain_id": chain_id,
            },
            timeout=timeout,
        )

    def publish_chain(
        self,
        *,
        chain_id: str,
        body: Optional[dict[str, Any]] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Publish a chain

        Publishes the chain specified by the chain_id.
        """
        return self._client.request(
            "POST",
            self._api,
            "/v1/chains/{chain_id}/publish",
            path_params={
                "chain_id": chain_id,
            },
            json_body=body,
            timeout=timeout,
        )

    async def publish_chain_async(
        self,
        *,
        chain_id: str,
        body: Optional[dict[str, Any]] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Publish a chain (async)

        Publishes the chain specified by the chain_id.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/v1/chains/{chain_id}/publish",
            path_params={
                "chain_id": chain_id,
            },
            json_body=body,
            timeout=timeout,
        )

    def import_chain(
        self,
        *,
        environment_id: str,
        body: dict[str, Any],
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import a chain

        Takes a .chain file and imports it into the provided environment.
        Returns chain metadata for the imported chain.
        > **Note:** .chain export files will automatically expire and become
        unusable after 14 days.  Expired .chain files remain on the exported
        system until removed manually.
        """
        return self._client.request(
            "POST",
            self._api,
            "/v1/environments/{environment_id}/import_chain",
            path_params={
                "environment_id": environment_id,
            },
            files=body,
            timeout=timeout,
        )

    async def import_chain_async(
        self,
        *,
        environment_id: str,
        body: dict[str, Any],
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import a chain (async)

        Takes a .chain file and imports it into the provided environment.
        Returns chain metadata for the imported chain.
        > **Note:** .chain export files will automatically expire and become
        unusable after 14 days.  Expired .chain files remain on the exported
        system until removed manually.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/v1/environments/{environment_id}/import_chain",
            path_params={
                "environment_id": environment_id,
            },
            files=body,
            timeout=timeout,
        )

    def search_chains(
        self,
        *,
        workspace_id: Optional[int] = None,
        external_workspace_id: Optional[str] = None,
        environment_id: Optional[int] = None,
        name: Optional[str] = None,
        parallel_execution_enabled: Optional[bool] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search chains

        Returns a list of all chains that match the provided criteria. The name
        of the change is fuzzy matched; it matches any chain name that contains
        the provided string. The workspace, external workspace, and environment
        IDs all help filter down the results to a particular setting. Setting
        the parallel execution enabled flag will only return chains whose
        commands run in parallel.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/metadata/chains/search",
            query_params={
                "workspace_id": workspace_id,
                "external_workspace_id": external_workspace_id,
                "environment_id": environment_id,
                "name": name,
                "parallel_execution_enabled": parallel_execution_enabled,
            },
            timeout=timeout,
        )

    async def search_chains_async(
        self,
        *,
        workspace_id: Optional[int] = None,
        external_workspace_id: Optional[str] = None,
        environment_id: Optional[int] = None,
        name: Optional[str] = None,
        parallel_execution_enabled: Optional[bool] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search chains (async)

        Returns a list of all chains that match the provided criteria. The name
        of the change is fuzzy matched; it matches any chain name that contains
        the provided string. The workspace, external workspace, and environment
        IDs all help filter down the results to a particular setting. Setting
        the parallel execution enabled flag will only return chains whose
        commands run in parallel.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/metadata/chains/search",
            query_params={
                "workspace_id": workspace_id,
                "external_workspace_id": external_workspace_id,
                "environment_id": environment_id,
                "name": name,
                "parallel_execution_enabled": parallel_execution_enabled,
            },
            timeout=timeout,
        )

    def get_chains(
        self,
        *,
        environment_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return a list of chains for an environment

        Retrieves a list of chains for an environment.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain",
            path_params={
                "environment_id": environment_id,
            },
            timeout=timeout,
        )

    async def get_chains_async(
        self,
        *,
        environment_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return a list of chains for an environment (async)

        Retrieves a list of chains for an environment.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain",
            path_params={
                "environment_id": environment_id,
            },
            timeout=timeout,
        )

    def get_chain(
        self,
        *,
        environment_id: str,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain properties

        Returns properties for a chain with the provided ID, or a 404 if no such
        chain is found.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain/{chain_id}",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            timeout=timeout,
        )

    async def get_chain_async(
        self,
        *,
        environment_id: str,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain properties (async)

        Returns properties for a chain with the provided ID, or a 404 if no such
        chain is found.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain/{chain_id}",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            timeout=timeout,
        )

    def get_commands(
        self,
        *,
        environment_id: str,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return command properties

        Returns properties for a command with the provided ID, or a 404 if no
        such command is found.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain/{chain_id}/command",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            timeout=timeout,
        )

    async def get_commands_async(
        self,
        *,
        environment_id: str,
        chain_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return command properties (async)

        Returns properties for a command with the provided ID, or a 404 if no
        such command is found.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/metadata/environment/{environment_id}/chain/{chain_id}/command",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            timeout=timeout,
        )
