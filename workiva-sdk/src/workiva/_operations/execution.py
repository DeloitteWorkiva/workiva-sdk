"""Chains API â€” execution namespace.

Auto-generated by codegen. Do not edit manually.
"""

from __future__ import annotations

from typing import Any, Optional

import httpx

from workiva._constants import _API
from workiva._operations._base import BaseNamespace


class Execution(BaseNamespace):
    """Execution operations."""

    _api: _API = _API.CHAINS

    def chain_filter_search(
        self,
        *,
        environment_id: Optional[list[ID]] = None,
        chain_id: Optional[list[ID]] = None,
        start_date: Optional[str] = None,
        end_date: Optional[str] = None,
        state: Optional[str] = None,
        sort: Optional[str] = None,
        cursor: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search previous chain runs

        Returns a list of all previous chain runs that match the provided
        criteria. The environment IDs specify which environments should be
        searched for the chain run. The chain IDs specify which specific chains
        should be returned. The state specified returns only those chains that
        are in that state (e.g. "completed"). If a cursor is provided, the
        corresponding page will be returned.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/execute/chain_run/search",
            query_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
                "start_date": start_date,
                "end_date": end_date,
                "state": state,
                "sort": sort,
                "cursor": cursor,
            },
            timeout=timeout,
        )

    async def chain_filter_search_async(
        self,
        *,
        environment_id: Optional[list[ID]] = None,
        chain_id: Optional[list[ID]] = None,
        start_date: Optional[str] = None,
        end_date: Optional[str] = None,
        state: Optional[str] = None,
        sort: Optional[str] = None,
        cursor: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search previous chain runs (async)

        Returns a list of all previous chain runs that match the provided
        criteria. The environment IDs specify which environments should be
        searched for the chain run. The chain IDs specify which specific chains
        should be returned. The state specified returns only those chains that
        are in that state (e.g. "completed"). If a cursor is provided, the
        corresponding page will be returned.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/execute/chain_run/search",
            query_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
                "start_date": start_date,
                "end_date": end_date,
                "state": state,
                "sort": sort,
                "cursor": cursor,
            },
            timeout=timeout,
        )

    def get_chain_run(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain run properties

        Returns properties for a chain run with the provided ID, or a 404 if no
        such chain run is found.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    async def get_chain_run_async(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain run properties (async)

        Returns properties for a chain run with the provided ID, or a 404 if no
        such chain run is found.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    def get_chain_run_nodes(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain run properties with nodes

        Returns properties and nodes for a chain run with the provided ID, or a
        404 if no such chain run is found.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}/nodes",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    async def get_chain_run_nodes_async(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return chain run properties with nodes (async)

        Returns properties and nodes for a chain run with the provided ID, or a
        404 if no such chain run is found.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}/nodes",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    def stop_chain(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Stop a running chain

        Stop a chain run with the specified ID.
        """
        return self._client.request(
            "POST",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}/stop",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    async def stop_chain_async(
        self,
        *,
        chain_run_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Stop a running chain (async)

        Stop a chain run with the specified ID.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/v1/execute/chain_run/{chain_run_id}/stop",
            path_params={
                "chain_run_id": chain_run_id,
            },
            timeout=timeout,
        )

    def chain_inputs_search(
        self,
        *,
        environment_id: str,
        search_text: str,
        limit: Optional[str] = None,
        cursor: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search previous chain runs for an input value

        Returns a list of all chain runs whose inputs match the provided search
        criteria. The search text is fuzzy matched; it matches any input value
        that contains the provided string. For example, a command that takes a
        File ID of "my_file_id" as an input can be searched using "my_file_id"
        as the search text input. The environment ID specifies which environment
        should be searched for chain run input parameters. The limit and cursor
        help determine the page size and which page to return.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/inputs_search",
            path_params={
                "environment_id": environment_id,
            },
            query_params={
                "search_text": search_text,
                "limit": limit,
                "cursor": cursor,
            },
            timeout=timeout,
        )

    async def chain_inputs_search_async(
        self,
        *,
        environment_id: str,
        search_text: str,
        limit: Optional[str] = None,
        cursor: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Search previous chain runs for an input value (async)

        Returns a list of all chain runs whose inputs match the provided search
        criteria. The search text is fuzzy matched; it matches any input value
        that contains the provided string. For example, a command that takes a
        File ID of "my_file_id" as an input can be searched using "my_file_id"
        as the search text input. The environment ID specifies which environment
        should be searched for chain run input parameters. The limit and cursor
        help determine the page size and which page to return.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/inputs_search",
            path_params={
                "environment_id": environment_id,
            },
            query_params={
                "search_text": search_text,
                "limit": limit,
                "cursor": cursor,
            },
            timeout=timeout,
        )

    def chain_run_history(
        self,
        *,
        environment_id: str,
        chain_id: str,
        limit: Optional[str] = None,
        cursor: Optional[str] = None,
        start_date: Optional[str] = None,
        end_date: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return run history for a chain

        Retrieves a list of run history for a chain.
        """
        return self._client.request(
            "GET",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/{chain_id}/history",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            query_params={
                "limit": limit,
                "cursor": cursor,
                "start_date": start_date,
                "end_date": end_date,
            },
            timeout=timeout,
        )

    async def chain_run_history_async(
        self,
        *,
        environment_id: str,
        chain_id: str,
        limit: Optional[str] = None,
        cursor: Optional[str] = None,
        start_date: Optional[str] = None,
        end_date: Optional[str] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Return run history for a chain (async)

        Retrieves a list of run history for a chain.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/{chain_id}/history",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            query_params={
                "limit": limit,
                "cursor": cursor,
                "start_date": start_date,
                "end_date": end_date,
            },
            timeout=timeout,
        )

    def start_chain(
        self,
        *,
        environment_id: str,
        chain_id: str,
        body: dict[str, Any],
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Execute a chain

        Starts a chain run for a specific chain in an environment, specified by
        the Chain and Environment ID.
        """
        return self._client.request(
            "POST",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/{chain_id}/start",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            json_body=body,
            timeout=timeout,
        )

    async def start_chain_async(
        self,
        *,
        environment_id: str,
        chain_id: str,
        body: dict[str, Any],
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Execute a chain (async)

        Starts a chain run for a specific chain in an environment, specified by
        the Chain and Environment ID.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/v1/execute/environment/{environment_id}/chain/{chain_id}/start",
            path_params={
                "environment_id": environment_id,
                "chain_id": chain_id,
            },
            json_body=body,
            timeout=timeout,
        )
