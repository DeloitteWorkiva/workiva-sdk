"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .cellrange import CellRange, CellRangeTypedDict
from .drawingelementanchorattachmentpointtype import (
    DrawingElementAnchorAttachmentPointType,
)
from .drawingrichtextselection import (
    DrawingRichTextSelection,
    DrawingRichTextSelectionTypedDict,
)
from .drawingrichtextselectionanchorattachmentpointtype import (
    DrawingRichTextSelectionAnchorAttachmentPointType,
)
from .richtextselection import RichTextSelection, RichTextSelectionTypedDict
from .richtextselectionanchorattachmentpointtype import (
    RichTextSelectionAnchorAttachmentPointType,
)
from enum import Enum
import pydantic
from pydantic import field_serializer, model_serializer
from typing import List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict
from workiva import models, utils
from workiva.types import BaseModel, Nullable, OptionalNullable, UNSET, UNSET_SENTINEL


class AnchorAttachmentPointRichTextSelectionTypedDict(TypedDict):
    r"""An attachment point to a selection in rich text content."""

    selection: NotRequired[RichTextSelectionTypedDict]
    r"""Describes a selection within piece of rich text"""
    type: NotRequired[RichTextSelectionAnchorAttachmentPointType]
    r"""The type of attachment point."""


class AnchorAttachmentPointRichTextSelection(BaseModel):
    r"""An attachment point to a selection in rich text content."""

    selection: Optional[RichTextSelection] = None
    r"""Describes a selection within piece of rich text"""

    type: Optional[RichTextSelectionAnchorAttachmentPointType] = None
    r"""The type of attachment point."""

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.RichTextSelectionAnchorAttachmentPointType(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["selection", "type"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class TableRangeTypedDict(TypedDict):
    r"""A table range anchor attachment point."""

    range: NotRequired[CellRangeTypedDict]


class TableRange(BaseModel):
    r"""A table range anchor attachment point."""

    range: Optional[CellRange] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["range"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class DrawingSelectionTypedDict(TypedDict):
    r"""An attachment point to a selection of drawing elements in a drawing."""

    selection: List[str]
    r"""A selection of one or more drawing elements"""
    type: DrawingElementAnchorAttachmentPointType
    r"""The type of attachment point."""


class DrawingSelection(BaseModel):
    r"""An attachment point to a selection of drawing elements in a drawing."""

    selection: List[str]
    r"""A selection of one or more drawing elements"""

    type: DrawingElementAnchorAttachmentPointType
    r"""The type of attachment point."""


class AnchorAttachmentPointDrawingRichTextSelectionTypedDict(TypedDict):
    r"""An attachment point to a selection in a drawing's rich text content."""

    selection: DrawingRichTextSelectionTypedDict
    r"""Describes a selection within a drawing element's text"""
    type: DrawingRichTextSelectionAnchorAttachmentPointType
    r"""The type of attachment point."""


class AnchorAttachmentPointDrawingRichTextSelection(BaseModel):
    r"""An attachment point to a selection in a drawing's rich text content."""

    selection: DrawingRichTextSelection
    r"""Describes a selection within a drawing element's text"""

    type: DrawingRichTextSelectionAnchorAttachmentPointType
    r"""The type of attachment point."""

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.DrawingRichTextSelectionAnchorAttachmentPointType(value)
            except ValueError:
                return value
        return value


class AnchorAttachmentPointType(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The type of attachment point."""

    RICH_TEXT_SELECTION = "richTextSelection"
    TABLE_RANGE = "tableRange"
    DRAWING_SELECTION = "drawingSelection"
    DRAWING_RICH_TEXT_SELECTION = "drawingRichTextSelection"


class AnchorAttachmentPointTypedDict(TypedDict):
    r"""An attachment point for an anchor."""

    rich_text_selection: NotRequired[
        Nullable[AnchorAttachmentPointRichTextSelectionTypedDict]
    ]
    table_range: NotRequired[Nullable[TableRangeTypedDict]]
    drawing_selection: NotRequired[Nullable[DrawingSelectionTypedDict]]
    drawing_rich_text_selection: NotRequired[
        Nullable[AnchorAttachmentPointDrawingRichTextSelectionTypedDict]
    ]
    type: NotRequired[AnchorAttachmentPointType]
    r"""The type of attachment point."""


class AnchorAttachmentPoint(BaseModel):
    r"""An attachment point for an anchor."""

    rich_text_selection: Annotated[
        OptionalNullable[AnchorAttachmentPointRichTextSelection],
        pydantic.Field(alias="richTextSelection"),
    ] = UNSET

    table_range: Annotated[
        OptionalNullable[TableRange], pydantic.Field(alias="tableRange")
    ] = UNSET

    drawing_selection: Annotated[
        OptionalNullable[DrawingSelection], pydantic.Field(alias="drawingSelection")
    ] = UNSET

    drawing_rich_text_selection: Annotated[
        OptionalNullable[AnchorAttachmentPointDrawingRichTextSelection],
        pydantic.Field(alias="drawingRichTextSelection"),
    ] = UNSET

    type: Optional[AnchorAttachmentPointType] = None
    r"""The type of attachment point."""

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.AnchorAttachmentPointType(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "richTextSelection",
                "tableRange",
                "drawingSelection",
                "drawingRichTextSelection",
                "type",
            ]
        )
        nullable_fields = set(
            [
                "richTextSelection",
                "tableRange",
                "drawingSelection",
                "drawingRichTextSelection",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)
            is_nullable_and_explicitly_set = (
                k in nullable_fields
                and (self.__pydantic_fields_set__.intersection({n}))  # pylint: disable=no-member
            )

            if val != UNSET_SENTINEL:
                if (
                    val is not None
                    or k not in optional_fields
                    or is_nullable_and_explicitly_set
                ):
                    m[k] = val

        return m
