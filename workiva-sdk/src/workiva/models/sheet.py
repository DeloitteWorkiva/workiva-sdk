"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .tableref import TableRef, TableRefTypedDict
from .tableref_input import TableRefInput, TableRefInputTypedDict
from enum import Enum
import pydantic
from pydantic import field_serializer, model_serializer
from typing import Any, List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict
from workiva import models, utils
from workiva.types import BaseModel, Nullable, OptionalNullable, UNSET, UNSET_SENTINEL


class SheetDatasetTypedDict(TypedDict):
    r"""The range of the dataset on this sheet, if one exists.
    * To modify a dataset, either [update](ref:upsertdatasets) or [delete](ref:deletedatasetbysheetid) it.
    """

    range: NotRequired[Nullable[str]]
    r"""A1 style notation describing the range. Datasets are always located in the top left-hand corner of the sheet, so there is no need to specify range when creating a dataset."""
    sheet: NotRequired[str]
    r"""The unique identifier of the sheet to which this dataset belongs."""
    values: NotRequired[Nullable[List[List[Any]]]]
    r"""A row-major ordered multidimensional array of cell values."""


class SheetDataset(BaseModel):
    r"""The range of the dataset on this sheet, if one exists.
    * To modify a dataset, either [update](ref:upsertdatasets) or [delete](ref:deletedatasetbysheetid) it.
    """

    range: OptionalNullable[str] = UNSET
    r"""A1 style notation describing the range. Datasets are always located in the top left-hand corner of the sheet, so there is no need to specify range when creating a dataset."""

    sheet: Optional[str] = None
    r"""The unique identifier of the sheet to which this dataset belongs."""

    values: OptionalNullable[List[List[Any]]] = UNSET
    r"""A row-major ordered multidimensional array of cell values."""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["range", "sheet", "values"])
        nullable_fields = set(["range", "values"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)
            is_nullable_and_explicitly_set = (
                k in nullable_fields
                and (self.__pydantic_fields_set__.intersection({n}))  # pylint: disable=no-member
            )

            if val != UNSET_SENTINEL:
                if (
                    val is not None
                    or k not in optional_fields
                    or is_nullable_and_explicitly_set
                ):
                    m[k] = val

        return m


class SheetLock(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The type of lock applied to this sheet, if any. Note this property is not tied to revision and will always reflect the sheet's current lock state."""

    LOCK = "lock"
    INPUT_MODE = "inputMode"


class SheetParentTypedDict(TypedDict):
    r"""Partial reference to the parent sheet"""

    id: NotRequired[str]
    name: NotRequired[str]


class SheetParent(BaseModel):
    r"""Partial reference to the parent sheet"""

    id: Optional[str] = None

    name: Optional[str] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["id", "name"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class SheetTypedDict(TypedDict):
    r"""Details about the sheet, including its ID and name."""

    children: NotRequired[List[SheetTypedDict]]
    r"""An array of partial information about any child sheets"""
    custom_fields: NotRequired[Any]
    r"""A map of ids to values representing Custom Fields on the sheet.

    """
    dataset: NotRequired[Nullable[SheetDatasetTypedDict]]
    r"""The range of the dataset on this sheet, if one exists.
    * To modify a dataset, either [update](ref:upsertdatasets) or [delete](ref:deletedatasetbysheetid) it.
    """
    id: NotRequired[Nullable[str]]
    r"""The unique identifier of the sheet"""
    index: NotRequired[int]
    r"""The integer index of the sheet relative to its parent sheet or to the spreadsheet, if no parent sheet. To position a sheet at the end of its siblings, use the special value -1."""
    lock: NotRequired[Nullable[SheetLock]]
    r"""The type of lock applied to this sheet, if any. Note this property is not tied to revision and will always reflect the sheet's current lock state."""
    name: NotRequired[str]
    r"""The name of the sheet"""
    parent: NotRequired[Nullable[SheetParentTypedDict]]
    r"""Partial reference to the parent sheet"""
    revision: NotRequired[str]
    r"""The revision of the sheet"""
    table: NotRequired[TableRefTypedDict]
    r"""A reference to table content in a document, spreadsheet, or presentation

    """


class Sheet(BaseModel):
    r"""Details about the sheet, including its ID and name."""

    children: Optional[List[Sheet]] = None
    r"""An array of partial information about any child sheets"""

    custom_fields: Annotated[Optional[Any], pydantic.Field(alias="customFields")] = None
    r"""A map of ids to values representing Custom Fields on the sheet.

    """

    dataset: OptionalNullable[SheetDataset] = UNSET
    r"""The range of the dataset on this sheet, if one exists.
    * To modify a dataset, either [update](ref:upsertdatasets) or [delete](ref:deletedatasetbysheetid) it.
    """

    id: OptionalNullable[str] = UNSET
    r"""The unique identifier of the sheet"""

    index: Optional[int] = None
    r"""The integer index of the sheet relative to its parent sheet or to the spreadsheet, if no parent sheet. To position a sheet at the end of its siblings, use the special value -1."""

    lock: OptionalNullable[SheetLock] = UNSET
    r"""The type of lock applied to this sheet, if any. Note this property is not tied to revision and will always reflect the sheet's current lock state."""

    name: Optional[str] = None
    r"""The name of the sheet"""

    parent: OptionalNullable[SheetParent] = UNSET
    r"""Partial reference to the parent sheet"""

    revision: Optional[str] = None
    r"""The revision of the sheet"""

    table: Optional[TableRef] = None
    r"""A reference to table content in a document, spreadsheet, or presentation

    """

    @field_serializer("lock")
    def serialize_lock(self, value):
        if isinstance(value, str):
            try:
                return models.SheetLock(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "children",
                "customFields",
                "dataset",
                "id",
                "index",
                "lock",
                "name",
                "parent",
                "revision",
                "table",
            ]
        )
        nullable_fields = set(["dataset", "id", "lock", "parent"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)
            is_nullable_and_explicitly_set = (
                k in nullable_fields
                and (self.__pydantic_fields_set__.intersection({n}))  # pylint: disable=no-member
            )

            if val != UNSET_SENTINEL:
                if (
                    val is not None
                    or k not in optional_fields
                    or is_nullable_and_explicitly_set
                ):
                    m[k] = val

        return m


class SheetInputTypedDict(TypedDict):
    r"""Details about the sheet, including its ID and name."""

    custom_fields: NotRequired[Any]
    r"""A map of ids to values representing Custom Fields on the sheet.

    """
    id: NotRequired[Nullable[str]]
    r"""The unique identifier of the sheet"""
    index: NotRequired[int]
    r"""The integer index of the sheet relative to its parent sheet or to the spreadsheet, if no parent sheet. To position a sheet at the end of its siblings, use the special value -1."""
    lock: NotRequired[Nullable[SheetLock]]
    r"""The type of lock applied to this sheet, if any. Note this property is not tied to revision and will always reflect the sheet's current lock state."""
    name: NotRequired[str]
    r"""The name of the sheet"""
    parent: NotRequired[Nullable[SheetParentTypedDict]]
    r"""Partial reference to the parent sheet"""
    table: NotRequired[TableRefInputTypedDict]
    r"""A reference to table content in a document, spreadsheet, or presentation

    """


class SheetInput(BaseModel):
    r"""Details about the sheet, including its ID and name."""

    custom_fields: Annotated[Optional[Any], pydantic.Field(alias="customFields")] = None
    r"""A map of ids to values representing Custom Fields on the sheet.

    """

    id: OptionalNullable[str] = UNSET
    r"""The unique identifier of the sheet"""

    index: Optional[int] = None
    r"""The integer index of the sheet relative to its parent sheet or to the spreadsheet, if no parent sheet. To position a sheet at the end of its siblings, use the special value -1."""

    lock: OptionalNullable[SheetLock] = UNSET
    r"""The type of lock applied to this sheet, if any. Note this property is not tied to revision and will always reflect the sheet's current lock state."""

    name: Optional[str] = None
    r"""The name of the sheet"""

    parent: OptionalNullable[SheetParent] = UNSET
    r"""Partial reference to the parent sheet"""

    table: Optional[TableRefInput] = None
    r"""A reference to table content in a document, spreadsheet, or presentation

    """

    @field_serializer("lock")
    def serialize_lock(self, value):
        if isinstance(value, str):
            try:
                return models.SheetLock(value)
            except ValueError:
                return value
        return value

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            ["customFields", "id", "index", "lock", "name", "parent", "table"]
        )
        nullable_fields = set(["id", "lock", "parent"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)
            is_nullable_and_explicitly_set = (
                k in nullable_fields
                and (self.__pydantic_fields_set__.intersection({n}))  # pylint: disable=no-member
            )

            if val != UNSET_SENTINEL:
                if (
                    val is not None
                    or k not in optional_fields
                    or is_nullable_and_explicitly_set
                ):
                    m[k] = val

        return m
