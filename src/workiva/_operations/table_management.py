"""Wdata API â€” table_management namespace.

Auto-generated by codegen. Do not edit manually.
"""

from __future__ import annotations

from typing import Any, Optional

import httpx

from workiva._constants import _API
from workiva._operations._base import BaseNamespace
from workiva.models.wdata import (
    ImportDto,
    ImportFromSpreadsheetDto,
    TableDto,
)


class TableManagement(BaseNamespace):
    """TableManagement operations."""

    _api: _API = _API.WDATA

    def create_table(
        self,
        *,
        body: TableDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Create a new table

        Creates a table in the database with the specified schema. For type,
        specify either a dimension or data table. In the interface, data tables
        appear as fact tables.
        """
        return self._client.request(
            "POST",
            self._api,
            "/api/v1/table",
            json_body=body,
            timeout=timeout,
        )

    async def create_table_async(
        self,
        *,
        body: TableDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Create a new table (async)

        Creates a table in the database with the specified schema. For type,
        specify either a dimension or data table. In the interface, data tables
        appear as fact tables.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/api/v1/table",
            json_body=body,
            timeout=timeout,
        )

    def get_tables(
        self,
        *,
        include_shared: Optional[bool] = False,
        cursor: Optional[str] = None,
        limit: Optional[int] = 1000,
        offset: Optional[int] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a list of tables

        Returns all tables available in the workspace.
        """
        return self._client.request(
            "GET",
            self._api,
            "/api/v1/table",
            query_params={
                "includeShared": include_shared,
                "cursor": cursor,
                "limit": limit,
                "offset": offset,
            },
            timeout=timeout,
        )

    async def get_tables_async(
        self,
        *,
        include_shared: Optional[bool] = False,
        cursor: Optional[str] = None,
        limit: Optional[int] = 1000,
        offset: Optional[int] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a list of tables (async)

        Returns all tables available in the workspace.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/api/v1/table",
            query_params={
                "includeShared": include_shared,
                "cursor": cursor,
                "limit": limit,
                "offset": offset,
            },
            timeout=timeout,
        )

    def update_table(
        self,
        *,
        table_id: str,
        body: TableDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Update a single table

        Updates an existing table with the provided information. Include all
        user-defined
        table columns with the request. For type, specify either a dimension or
        data table.
        In the interface, data tables appear as fact tables.
        * If the table has no imported
        data, user-defined columns not included with the request are deleted,
        and columns are
        sorted according to their order in the request.
        * If the table has imported data,
        any columns with names not already in the table are considered new. This
        equality
        check is case-insensitive. Any new columns appear after other user-
        defined columns,
        but before any meta columns, which start with `_`.
        """
        return self._client.request(
            "PUT",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )

    async def update_table_async(
        self,
        *,
        table_id: str,
        body: TableDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Update a single table (async)

        Updates an existing table with the provided information. Include all
        user-defined
        table columns with the request. For type, specify either a dimension or
        data table.
        In the interface, data tables appear as fact tables.
        * If the table has no imported
        data, user-defined columns not included with the request are deleted,
        and columns are
        sorted according to their order in the request.
        * If the table has imported data,
        any columns with names not already in the table are considered new. This
        equality
        check is case-insensitive. Any new columns appear after other user-
        defined columns,
        but before any meta columns, which start with `_`.
        """
        return await self._client.request_async(
            "PUT",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )

    def get_table(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a single table

        Returns a table with the provided ID, or a 404 if no such table is
        found.
        """
        return self._client.request(
            "GET",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    async def get_table_async(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a single table (async)

        Returns a table with the provided ID, or a 404 if no such table is
        found.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    def delete_table(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Delete a single table

        Soft-deletes the table with the provided ID.
        """
        return self._client.request(
            "DELETE",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    async def delete_table_async(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Delete a single table (async)

        Soft-deletes the table with the provided ID.
        """
        return await self._client.request_async(
            "DELETE",
            self._api,
            "/api/v1/table/{tableId}",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    def get_dependents(
        self,
        *,
        table_id: str,
        cursor: Optional[str] = None,
        limit: Optional[int] = 1000,
        offset: Optional[int] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a list of dependents

        Returns a list of all queries that use the table with provided ID as a
        datasource.
        If a shared table, this may include queries outside of the current OAuth
        context.
        Permission is checked only for the table ID provided, _not_ on the
        returned list of
        queries.
        """
        return self._client.request(
            "GET",
            self._api,
            "/api/v1/table/{tableId}/dependents",
            path_params={
                "tableId": table_id,
            },
            query_params={
                "cursor": cursor,
                "limit": limit,
                "offset": offset,
            },
            timeout=timeout,
        )

    async def get_dependents_async(
        self,
        *,
        table_id: str,
        cursor: Optional[str] = None,
        limit: Optional[int] = 1000,
        offset: Optional[int] = None,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve a list of dependents (async)

        Returns a list of all queries that use the table with provided ID as a
        datasource.
        If a shared table, this may include queries outside of the current OAuth
        context.
        Permission is checked only for the table ID provided, _not_ on the
        returned list of
        queries.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/api/v1/table/{tableId}/dependents",
            path_params={
                "tableId": table_id,
            },
            query_params={
                "cursor": cursor,
                "limit": limit,
                "offset": offset,
            },
            timeout=timeout,
        )

    def import_file(
        self,
        *,
        table_id: str,
        body: ImportDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import a single file

        Imports the provided file into the associated table, and immediately
        returns a
        file meta object with an ID that can be used to poll the file controller
        for status.
        """
        return self._client.request(
            "POST",
            self._api,
            "/api/v1/table/{tableId}/import",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )

    async def import_file_async(
        self,
        *,
        table_id: str,
        body: ImportDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import a single file (async)

        Imports the provided file into the associated table, and immediately
        returns a
        file meta object with an ID that can be used to poll the file controller
        for status.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/api/v1/table/{tableId}/import",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )

    def unimport_file(
        self,
        *,
        table_id: str,
        file_id: str,
        force: Optional[str] = "false",
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Unimport a single file

        Unimports the provided file from the provided table. Returns a 409 if
        the file is
        not in an imported state, or a 404 if the file can't be found.
        """
        return self._client.request(
            "DELETE",
            self._api,
            "/api/v1/table/{tableId}/import/{fileId}",
            path_params={
                "tableId": table_id,
                "fileId": file_id,
            },
            query_params={
                "force": force,
            },
            timeout=timeout,
        )

    async def unimport_file_async(
        self,
        *,
        table_id: str,
        file_id: str,
        force: Optional[str] = "false",
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Unimport a single file (async)

        Unimports the provided file from the provided table. Returns a 409 if
        the file is
        not in an imported state, or a 404 if the file can't be found.
        """
        return await self._client.request_async(
            "DELETE",
            self._api,
            "/api/v1/table/{tableId}/import/{fileId}",
            path_params={
                "tableId": table_id,
                "fileId": file_id,
            },
            query_params={
                "force": force,
            },
            timeout=timeout,
        )

    def get_import_info(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve import information

        Returns information around imported files for a table.
        """
        return self._client.request(
            "GET",
            self._api,
            "/api/v1/table/{tableId}/importInfo",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    async def get_import_info_async(
        self,
        *,
        table_id: str,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Retrieve import information (async)

        Returns information around imported files for a table.
        """
        return await self._client.request_async(
            "GET",
            self._api,
            "/api/v1/table/{tableId}/importInfo",
            path_params={
                "tableId": table_id,
            },
            timeout=timeout,
        )

    def import_from_spreadsheets(
        self,
        *,
        table_id: str,
        body: ImportFromSpreadsheetDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import from spreadsheets

        Imports spreadsheet data and immediately returns a file meta result.
        This DTO has
        an ID, which can be used to poll on status via the file controller.
        """
        return self._client.request(
            "POST",
            self._api,
            "/api/v1/table/{tableId}/spreadsheet/import",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )

    async def import_from_spreadsheets_async(
        self,
        *,
        table_id: str,
        body: ImportFromSpreadsheetDto,
        timeout: Optional[float] = None,
    ) -> httpx.Response:
        """Import from spreadsheets (async)

        Imports spreadsheet data and immediately returns a file meta result.
        This DTO has
        an ID, which can be used to poll on status via the file controller.
        """
        return await self._client.request_async(
            "POST",
            self._api,
            "/api/v1/table/{tableId}/spreadsheet/import",
            path_params={
                "tableId": table_id,
            },
            json_body=body,
            timeout=timeout,
        )
