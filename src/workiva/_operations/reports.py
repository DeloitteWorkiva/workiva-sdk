"""Platform API â€” reports namespace.

Auto-generated by codegen. Do not edit manually.
"""

from __future__ import annotations

from typing import Any, Optional

import httpx

from workiva._constants import _API
from workiva._operations._base import BaseNamespace
from workiva._pagination import (
    extract_jsonapi_next,
    paginate_all,
    paginate_all_async,
)
from workiva.models.platform import (
    GetOrgReportUsersResponse,
)

__all__ = ["Reports"]


class Reports(BaseNamespace):
    """Reports operations."""

    _api: _API = _API.PLATFORM

    def get_org_report_users(
        self,
        *,
        organization_id: str,
        page_after: Optional[str] = None,
        page_size: Optional[int] = 100,
        timeout: Optional[float] = None,
    ) -> GetOrgReportUsersResponse:
        """List organization users

        Similar to an organization admin's "People View" export, this returns a
        paged list of specific details about the organization's users, including
        their usernames, display names, email addresses, SAML IDs, last logins,
        workspace memberships, licenses and roles. Results are sorted by
        displayName. <br /><br /> To obtain an organization's users, you need
        its organizationId. To view the organizationId in Wdesk, click your name
        in the lower left, and select <strong>Organization Admin</strong>. In
        the URL in your browser, the organizationId appears as a GUID after the
        /o/ such as 371b5fc8-fcc4-404a-9d22-d07d8f46a7e0. To view the ID of
        another organization you manage, select <strong>Switch
        Organizations</strong> from the left-hand menu, and search for and
        select the organization. <br /><br /> <strong>Requires the calling user
        to be an organization admin</strong>.

        Args:
            organization_id: The unique identifier of the organization
            page_after: Paging cursor
            page_size: Number of items to return. Maximum of 1000.
            timeout: Override the default request timeout (seconds).

        Returns:
            GetOrgReportUsersResponse

        Raises:
            WorkivaAPIError: On API errors (400, 401, 403, 404, 405, 415, 500, 501, 503).
        """

        def _fetch(_cursor: str | None) -> httpx.Response:
            return self._client.request(
                "GET",
                self._api,
                "/organizations/{organizationId}/orgReportUsers",
                path_params={
                    "organizationId": organization_id,
                },
                query_params={
                    "page[after]": page_after,
                    "page[size]": page_size,
                    "next": _cursor,
                },
                timeout=timeout,
            )

        _body_result = paginate_all(_fetch, extract_jsonapi_next, "data")
        return GetOrgReportUsersResponse.model_validate(_body_result)

    async def get_org_report_users_async(
        self,
        *,
        organization_id: str,
        page_after: Optional[str] = None,
        page_size: Optional[int] = 100,
        timeout: Optional[float] = None,
    ) -> GetOrgReportUsersResponse:
        """List organization users (async)

        Similar to an organization admin's "People View" export, this returns a
        paged list of specific details about the organization's users, including
        their usernames, display names, email addresses, SAML IDs, last logins,
        workspace memberships, licenses and roles. Results are sorted by
        displayName. <br /><br /> To obtain an organization's users, you need
        its organizationId. To view the organizationId in Wdesk, click your name
        in the lower left, and select <strong>Organization Admin</strong>. In
        the URL in your browser, the organizationId appears as a GUID after the
        /o/ such as 371b5fc8-fcc4-404a-9d22-d07d8f46a7e0. To view the ID of
        another organization you manage, select <strong>Switch
        Organizations</strong> from the left-hand menu, and search for and
        select the organization. <br /><br /> <strong>Requires the calling user
        to be an organization admin</strong>.

        Args:
            organization_id: The unique identifier of the organization
            page_after: Paging cursor
            page_size: Number of items to return. Maximum of 1000.
            timeout: Override the default request timeout (seconds).

        Returns:
            GetOrgReportUsersResponse

        Raises:
            WorkivaAPIError: On API errors (400, 401, 403, 404, 405, 415, 500, 501, 503).
        """

        async def _fetch(_cursor: str | None) -> httpx.Response:
            return await self._client.request_async(
                "GET",
                self._api,
                "/organizations/{organizationId}/orgReportUsers",
                path_params={
                    "organizationId": organization_id,
                },
                query_params={
                    "page[after]": page_after,
                    "page[size]": page_size,
                    "next": _cursor,
                },
                timeout=timeout,
            )

        _body_result = await paginate_all_async(_fetch, extract_jsonapi_next, "data")
        return GetOrgReportUsersResponse.model_validate(_body_result)
